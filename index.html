<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A cute Valentine's Day page to ask someone to be your Valentine!">
  <meta name="theme-color" content="#ffd0e5">
  <title>Valentine's Day</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <link rel="stylesheet" href="./styles.css">
  <!-- Preload images so transitions feel instant -->
  <link rel="preload" as="image" href="./images/image1.gif">
  <link rel="preload" as="image" href="./images/image2.gif">
  <link rel="preload" as="image" href="./images/image3.gif">
  <link rel="preload" as="image" href="./images/image4.gif">
  <link rel="preload" as="image" href="./images/image5.gif">
  <link rel="preload" as="image" href="./images/image6.gif">
  <link rel="preload" as="image" href="./images/image7.gif">
</head>
<body class="gradient-background">
  <main class="flex items-center justify-center h-screen">
    <section class="flex flex-col items-center p-4">
      <img
        id="imageDisplay"
        src="./images/image1.gif"
        alt="Cute kitten with flowers"
        class="rounded-md h-[300px] object-cover"
      />
      <h1 id="valentineQuestion" class="text-4xl font-bold italic text-[#bd1e59] my-4">
        Will you be my Valentine?
      </h1>
      <div id="responseButtons" class="flex gap-4 pt-5 items-center">
        <button
          id="yesButton"
          class="bounce inline-flex items-center justify-center whitespace-nowrap rounded-md text-xl font-medium cursor-pointer px-4 py-2 bg-green-500 text-white transition-all duration-300 ease-in-out hover:bg-green-400 min-h-12 min-w-[75px]"
        >
          Yes
        </button>
        <button
          id="noButton"
          class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-xl font-medium cursor-pointer px-4 py-2 bg-red-500 text-white transition-colors hover:bg-red-700 h-12 min-w-[75px]"
        >
          No
        </button>
      </div>

      <!-- Love letter (hidden until Yes) -->
      <section id="letterCard" class="w-full max-w-xl mt-8 hidden">
        <div class="rounded-2xl bg-white/80 backdrop-blur border border-pink-200 shadow-sm p-5">
          <div class="flex items-start justify-between gap-3">
            <div>
              <h2 class="text-2xl font-semibold text-[#bd1e59]">A letter for you</h2>
              <p class="text-sm text-pink-900/70 mt-1">Tap the little envelope.</p>
            </div>
            <button
              id="openLetterButton"
              class="shake inline-flex items-center justify-center rounded-md px-6 py-4 text-7xl bg-pink-600 text-white hover:bg-pink-500 transition"
              type="button"
              aria-label="Open letter"
            >
              ✉️
            </button>
          </div>

          <div class="mt-4">
            <div id="letterLockedNote" class="text-sm text-pink-900/70">
              <!-- Updated in JS after Yes is clicked -->
              <!-- Intentionally left subtle so there's no hint before Yes -->
            </div>

            <div class="letter-roll-container mt-4">
              <div id="letterBody" class="letter-roll text-pink-950/90 leading-relaxed">
                <p>My love,</p>
                <p class="mt-3">
                  I'm really grateful for you — for the way you make me feel understood, cared for, and
                  genuinely happy.
                </p>
                <p class="mt-3">
                  I love spending time with you, I love learning you, and I love the little moments
                  with you that end up meaning the most to me.
                </p>
                <p class="mt-3">
                  If you'll let me, I'd love to make this Valentine's Day special for us.
                </p>
                <p class="mt-3">Love,</p>
                <p>Your Name</p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>
  </main>

  <script>
    (() => {
      // DOM references
      const yesButton = document.getElementById('yesButton');
      const noButton = document.getElementById('noButton');
      const imageDisplay = document.getElementById('imageDisplay');
      const valentineQuestion = document.getElementById('valentineQuestion');
      const responseButtons = document.getElementById('responseButtons');
      const letterCard = document.getElementById('letterCard');
      const openLetterButton = document.getElementById('openLetterButton');
      const letterBody = document.getElementById('letterBody');
      const letterLockedNote = document.getElementById('letterLockedNote');

      // Configuration
      const GROWTH_PER_CLICK = 35;
      const FONT_GROWTH_PER_CLICK = 25;
      const MAX_NO_CLICKS = 5;

      const IMAGE_PATHS = [
        './images/image1.gif',
        './images/image2.gif',
        './images/image3.gif',
        './images/image4.gif',
        './images/image5.gif',
        './images/image6.gif',
        './images/image7.gif',
      ];

      const NO_BUTTON_MESSAGES = [
        'No',
        'Are you sure?',
        'Pookie please',
        "Don't do this to me :(",
        "You're breaking my heart",
        "I'm gonna cry...",
      ];

      const ALT_TEXTS = [
        'Cute kitten with flowers',
        'Sad kitten looking up',
        'Kitten begging',
        'Heartbroken kitten',
        'Crying kitten',
        'Devastated kitten',
        'Happy kitten celebrating',
      ];

      // State
      let noClickCount = 0;
      let buttonHeight = 48;
      let buttonWidth = 80;
      let fontSize = 20;
      let letterOpenedOnce = false;
      let noButtonSmashed = false;

      openLetterButton.addEventListener('click', () => {
        const isOpening = !letterBody.classList.contains('open');

        if (isOpening && !letterOpenedOnce) {
          letterOpenedOnce = true;

          // Small celebratory confetti when the letter is first opened
          confetti({
            particleCount: 40,
            spread: 70,
            startVelocity: 25,
            colors: ['#ff69b4', '#ff1493', '#ff6b81', '#e84393'],
          });
        }

        letterBody.classList.toggle('open');
      });

      noButton.addEventListener('click', () => {
        // After the final message ("I'm gonna cry..."), clicking again smashes the button away
        if (noClickCount >= MAX_NO_CLICKS) {
          if (noButtonSmashed) return;
          noButtonSmashed = true;
          noButton.disabled = true;
          noButton.classList.add('no-shatter');

          // Create hammer image positioned over the No button
          const rect = noButton.getBoundingClientRect();
          const hammer = document.createElement('img');
          hammer.src = './images/hammer.png';
          hammer.alt = 'Hammer smashing the No option';
          hammer.className = 'hammer-smash';
          hammer.style.left = `${rect.left + rect.width / 2}px`;
          hammer.style.top = `${rect.top}px`;
          document.body.appendChild(hammer);

          // Remove from layout after animation finishes
          setTimeout(() => {
            noButton.style.display = 'none';
            hammer.remove();
          }, 1300);
          return;
        }

        noClickCount++;

        // Update image and alt text
        imageDisplay.src = IMAGE_PATHS[noClickCount];
        imageDisplay.alt = ALT_TEXTS[noClickCount];

        // Grow the "Yes" button to make it harder to ignore
        buttonHeight += GROWTH_PER_CLICK;
        buttonWidth += GROWTH_PER_CLICK;
        fontSize += FONT_GROWTH_PER_CLICK;

        yesButton.style.height = `${buttonHeight}px`;
        yesButton.style.width = `${buttonWidth}px`;
        yesButton.style.fontSize = `${fontSize}px`;

        // Update "No" button text with increasingly desperate messages
        noButton.textContent = NO_BUTTON_MESSAGES[noClickCount];
      });

      yesButton.addEventListener('click', () => {
        imageDisplay.src = IMAGE_PATHS[IMAGE_PATHS.length - 1];
        imageDisplay.alt = ALT_TEXTS[ALT_TEXTS.length - 1];
        valentineQuestion.textContent = 'Yayyy!! :3';
        responseButtons.style.display = 'none';
        letterCard.classList.remove('hidden');
        letterLockedNote.textContent = 'Open it when you’re ready.';

        // Heart-shaped confetti for a valentine theme
        const heart = confetti.shapeFromPath({
          path: 'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z',
        });

        const defaults = { spread: 360, ticks: 100, gravity: 0, decay: 0.94, startVelocity: 20, shapes: [heart], colors: ['#ff69b4', '#ff1493', '#ff6b81', '#e84393'] };

        confetti({ ...defaults, particleCount: 50, scalar: 2 });
        confetti({ ...defaults, particleCount: 25, scalar: 3 });
        confetti({ ...defaults, particleCount: 10, scalar: 4 });
      });
    })();
  </script>
</body>
</html>
